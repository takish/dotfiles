---
allowed-tools: Bash(git:*), Read(**)
description: "Commit staged changes with auto-generated message"
---

以下の手順で変更をコミットしてください。

1. 変更の確認とステージング
2. 最近のコミットスタイルの確認
3. 変更されたファイルの内容確認（Readツールで実際のソースコードを読む）
4. コミットメッセージの生成とコミット実行
5. コミット結果の確認

# 変更の確認とステージング

まず、以下のコマンドを並列実行して、すべての変更を確認します。

```bash
git status
```

```bash
git diff
```

```bash
git diff --cached
```

変更がある場合は、関連するファイルをステージングエリアに追加してください：

- 未追跡ファイル（Untracked files）があれば、コミットに含めるべきファイルを `git add` で追加
- 変更されたファイル（modified）があれば、`git add` で追加
- シークレットファイル（.env、credentials.jsonなど）は追加しない
- 不要なファイル（ログ、一時ファイルなど）は追加しない

適切なファイルを以下のようにステージングしてください：

```bash
git add <関連ファイル>
```

複数ファイルがある場合は、`git add .` または個別に指定してください。

# 最近のコミットスタイルの確認

以下のコマンドでこのリポジトリの最近のコミットメッセージを確認し、スタイルを学習します。

```bash
git log -10 --oneline --no-decorate
```

# 変更されたファイルの内容確認

コミットメッセージを生成する前に、変更されたファイルの内容を確認してください：

1. `git diff --cached --name-only` で変更されたファイルのリストを取得
2. 主要な変更ファイル（特に重要な変更を含むファイル）をReadツールで読み取る
3. 変更の文脈、目的、影響範囲を理解する

ソースコードの内容から以下を分析してください：
- 新しい関数やクラスの追加
- 既存機能の修正や拡張
- バグ修正の詳細
- リファクタリングの内容
- 設定やドキュメントの更新

# コミットメッセージの生成とコミット実行

ステージングされた変更とソースコードの内容を分析し、以下の要件を満たすコミットメッセージを生成してください：

- **ソースコードから推測した変更の目的を反映する**
- 変更の性質を正確に反映する（新機能、機能強化、バグ修正、リファクタリング、テスト、ドキュメントなど）
- 「why」に焦点を当て、簡潔（1〜2文）にまとめる
- リポジトリの既存のコミットスタイルに合わせる
- 適切なプレフィックスを使用する（add, update, fix, refactorなど）

生成したコミットメッセージを使用して、以下のフォーマットでコミットを実行してください：

```bash
git commit -m "$(cat <<'EOF'
<生成したコミットメッセージをここに記入>

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```

# コミット結果の確認

コミット完了後、以下のコマンドで結果を確認します。

```bash
git status
```

```bash
git log -1 --stat
```
